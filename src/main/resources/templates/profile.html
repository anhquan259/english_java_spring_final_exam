<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">

<head>
    <!-- Basic -->
    <meta charset="utf-8"/>
    <meta content="IE=edge" http-equiv="X-UA-Compatible"/>
    <!-- Mobile Metas -->
    <meta content="width=device-width, initial-scale=1, shrink-to-fit=no" name="viewport"/>
    <!-- Site Metas -->
    <meta content="" name="keywords"/>
    <meta content="" name="description"/>
    <meta content="" name="author"/>

    <title>English Examination | Profile</title>

    <!-- bootstrap core css -->
    <link href="/css/bootstrap.css" rel="stylesheet" type="text/css"/>
    <!-- progress barstle -->
    <link href="/css/css-circular-prog-bar.css" rel="stylesheet">
    <!-- fonts style -->
    <link href="https://fonts.googleapis.com/css?family=Poppins:400,700|Raleway:400,600&display=swap" rel="stylesheet">
    <!-- font wesome stylesheet -->
    <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css" rel="stylesheet">
    <!-- Custom styles for this template -->
    <link href="/css/style.css" rel="stylesheet"/>
    <!-- Custom taskbar for this template -->
    <link href="/css/taskbar.css" rel="stylesheet"/>
    <!-- Custom taskbar for this template -->
    <link href="/css/profile.css" rel="stylesheet"/>
    <!-- responsive style -->
    <link href="/css/responsive.css" rel="stylesheet"/>
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">

    <link href="css/css-circular-prog-bar.css" rel="stylesheet">
</head>

<body class="sub_page">
<div class="top_container ">
    <!-- header section strats -->
    <header th:replace="fragments/header :: header"></header>

</div>
<!-- end header section -->


<!-- profile section -->
<section class="section-prolfile">
    <div class="container layout_padding2">
        <div class="row">
            <div class="col-md-4">
                <div class="container-name">
                    <img alt="avatar" class="avatar-profile" src="/images/avatar.jpg">
                </div>
                <div class="container-name">
                    <p class="name-profile" th:text="${user.Fullname}"></p>
                </div>
            </div>
            <div class="col-md-8">
                <!-- Thông báo kết quả cập nhật -->
                <div class="alert alert-info" th:if="${message}" th:text="${message}"></div>

                <div class="nav-bar-profile">
                    <div class="btn-navbar" id="info-id">Thông tin cá nhân</div>
                    <div class="btn-navbar" id="point-id">Bảng điểm cá nhân</div>
                </div>
                <div class="nav-bar-profile-active">
                    <div class="btn-navbar-active" id="info-active-id"></div>
                    <div class="btn-navbar-active" id="point-active-id" style="background-color: #ffffff;"></div>
                </div>

                <div class="info display" id="info">
                    <form action="/profile/edit" method="post">
                        <div>
                            <label class="label-profile">Họ và tên</label>
                            <input class="input-profile" id="name" name="fullname" readonly
                                   th:value="${user.Fullname}" type="text">
                        </div>
                        <br/>

                        <div>
                            <label class="label-profile">Email</label>
                            <input class="input-profile" id="email" readonly th:value="${user.username}" type="text">
                        </div>
                        <br/>

                        <div>
                            <label class="label-profile">Mật khẩu</label>
                            <input class="input-profile" id="password" name="password" readonly
                                   th:value="${user.password}" type="password">
                        </div>
                        <br/>

                        <div class="form-group input-password" id="input-password">
                            <label class="label-profile">Mật khẩu mới</label>
                            <div class="password-container">
                                <input class="input-profile" id="newpass" name="newpass" type="password">
                                <i class="fas fa-eye toggle-password" onclick="togglePassword('newpass', this)"></i>
                            </div>
                            <br/><br/>

                            <label class="label-profile">Nhập lại mật khẩu</label>
                            <div class="password-container">
                                <input class="input-profile" id="repass" name="repass" type="password">
                                <i class="fas fa-eye toggle-password" onclick="togglePassword('repass', this)"></i>
                            </div>
                            <br/>
                        </div>

                        <input class="btn-profile display" id="btn-edit" readonly value="Chỉnh sửa">
                        <input class="btn-profile" id="btn-submit" readonly type="submit" value="Lưu">
                    </form>
                </div>
                <div class="point" id="point">
                    <table class="table-point">
                        <thead>
                        <th class="table-element">STT</th>
                        <th class="table-element">Khóa học</th>
                        <th class="table-element">Ngày thi</th>
                        <th class="table-element">Điểm</th>
                        </thead>
                        <tbody>
                        <tr th:each="bangdiem, stt : ${user.diem}" th:with="count=${count}+1">
                            <th class="table-element" th:text="${stt.count}"></th>
                            <th class="table-element" th:text="${bangdiem.exam.examName}"></th>
                            <th class="table-element" th:text="${bangdiem.testDay}"></th>
                            <th class="table-element" th:text="${bangdiem.point}"></th>
                        </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>
</section>
<!-- end profile section -->

<!-- Popup Modal -->
<div id="successModal" class="modal">
    <div class="modal-content">
        <h3>Thông báo</h3>
        <p>Đổi mật khẩu thành công! Chuyển về màn hình đăng nhập sau 5 giây.</p>
    </div>
</div>

<section class="info_section layout_padding-top">
    <div class="info_logo-box">
        <h2>
            English Examination
        </h2>
    </div>
    <div class="container layout_padding2">
        <div class="row">
            <div class="col-md-3">
                <h5>
                    Về chúng tôi
                </h5>
                <p style="color: yellow">
                    Trang web giáo dục tiếng anh tốt nhất
                </p>
            </div>
            <div class="col-md-3">
                <h5>
                    Liên kết hữu ích
                </h5>
                <ul class="useful_links">
                    <a style="color: yellow" href="https://www.google.com" target="_blank">
                        <i class="fa fa-external-link"></i> Tìm kiếm Google
                    </a>
                </ul>
            </div>
            <div class="col-md-3">
                <h5>
                    Liên hệ chúng tôi
                </h5>
                <p>
                    <a class="fa fa-external-link" style="color: yellow;" th:href="@{/contact}"> Nhấn vào đây</a>
                </p>
            </div>
            <div class="col-md-3">

                <div class="subscribe_container">
                    <h5>
                        Bản tin
                    </h5>
                    <div class="form_container">
                        <form action="">
                            <input placeholder="Nhập email của bạn" type="email">
                            <button type="submit">
                                Đặt mua
                            </button>
                        </form>
                    </div>
                </div>

            </div>
        </div>
    </div>
    <div class="container">
        <div class="social_container">

            <div class="social-box">
                <a href="">
                    <img alt="" src="images/fb.png">
                </a>
                <a href="">
                    <img alt="" src="images/twitter.png">
                </a>
                <a href="">
                    <img alt="" src="images/linkedin.png">
                </a>
                <a href="">
                    <img alt="" src="images/instagram.png">
                </a>
            </div>
        </div>
    </div>
</section>

<!-- footer section -->
<section class="container-fluid footer_section">
    <p>
        Bản quyền thuộc về NAQ Education Group &copy; 2025
    </p>
</section>
<!-- footer section -->

<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js "></script>
<script>
    $(document).ready(function () {
        $("#info-id").click(function () {
            document.getElementById('info').classList.add("display");
            document.getElementById('point').classList.remove("display");
            document.getElementById('info-active-id').style.backgroundColor = "#fdd31d";
            document.getElementById('point-active-id').style.backgroundColor = "#ffffff";
        });
        $("#point-id").click(function () {
            document.getElementById('info').classList.remove("display");
            document.getElementById('point').classList.add("display");
            document.getElementById('point-active-id').style.backgroundColor = "#fdd31d";
            document.getElementById('info-active-id').style.backgroundColor = "#ffffff";
        });
        $("#btn-edit").click(function () {
            document.getElementById('btn-edit').classList.remove("display");
            document.getElementById('btn-submit').classList.add("display");
            document.getElementById('input-password').classList.add("display");
            document.getElementById('name').readOnly = false;
            document.getElementById('password').readOnly = false;
        });
    });
</script>

<script>
    // Hiện/ẩn mật khẩu
    function togglePassword(fieldId, icon) {
        const field = document.getElementById(fieldId);

        if (field.type === "password") {
            field.type = "text";
            icon.classList.remove("fa-eye");
            icon.classList.add("fa-eye-slash");
        } else {
            field.type = "password";
            icon.classList.remove("fa-eye-slash");
            icon.classList.add("fa-eye");
        }
    }

    function showSuccessModal(message) {
        const modal = document.getElementById('successModal');
        const modalContent = document.querySelector('#successModal .modal-content p');
        modalContent.textContent = message;
        modal.style.display = 'block';

        if (message.includes("thành công")) {
            setTimeout(function() {
                window.location.href = "/login";
            }, 5000);
        } else {
            setTimeout(function() {
                modal.style.display = 'none';
            }, 3000);
        }
    }

    // Lấy thông báo từ Thymeleaf
    const message = /*[[${message}]]*/ '';
    if (message && message.trim() !== '') {
        alert(message);
        if (message.includes("thành công")) {
            setTimeout(function() {
                window.location.href = "/login";
            }, 3000);
        }
    }

    document.getElementById('btn-edit').addEventListener('click', function () {
        document.getElementById('name').readOnly = false;
        document.getElementById('password').readOnly = false;
        document.getElementById('btn-edit').style.display = 'none';
        document.getElementById('btn-submit').style.display = 'block';
        document.getElementById('input-password').classList.remove("display");
    });
</script>

<script src="/js/jquery-3.4.1.min.js" type="text/javascript"></script>
<script src="/js/bootstrap.js" type="text/javascript"></script>

</body>
</html>